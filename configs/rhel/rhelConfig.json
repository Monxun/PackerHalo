
{
    "builders": [
        {
            "type": "amazon-ebs",
            "access_key": "{{user `aws_access_key`}}",
            "secret_key": "{{user `aws_secret_key`}}",
            "region": "{{user `aws_region`}}",

            "ami_name": "{{user `description`}}-{{user `aws_version`}}",
            "source_ami": "{{user `aws_source_ami`}}",
            "instance_type": "{{user `aws_instance_type`}}",
            "ssh_username": "{{user `aws_ssh_username`}}"
        }
    ],

    "provisioners": [
        {
            "type": "ansible",
            "playbook_file": "./ansible/rhelPlaybook.yaml",
            "extra_arguments": ["--skip-tags", "rule_6.2.1,rule_6.2.11,rule_6.2.12,rule_6.2.13,rule_6.2.14,rule_6.2.15,rule_6.2.16,rule_6.2.17"]
        }
    ],

    "post-processors": [
        {
            "type": "manifest",
            "output": "{{user `description`}}-{{user `version`}}-log.json"
        }
    ],

    "sensitive-variables": [
        "aws_access_key",
        "aws_secret_key"
    ]
}